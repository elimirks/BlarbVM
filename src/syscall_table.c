#include "vm.h"

// Don't worry, I wrote a script to generate this :)
// Refer to http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/
int SYSCALL_POINTER_TABLE[329][6] = {
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 1, 1, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 0, 1, 0 },
                                     { 0, 1, 0, 0, 1, 1 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 0, 0, 1, 1, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 1, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 1, 1, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 1, 1, 0, 0, 0, 0 },
                                     { 1, 0, 0, 1, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 1, 0 },
                                     { 0, 1, 0, 1, 1, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 0, 0, 1, 0, 1, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 1, 0, 1, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 1, 1, 1 },
                                     { 1, 0, 1, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 1, 1, 1, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 0, 1, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 1, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 1, 1, 0, 0 },
                                     { 0, 1, 1, 1, 0, 0 },
                                     { 0, 1, 1, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 1, 1, 1, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 0, 1, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 1, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 1, 1, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 0, 0, 0, 0, 0 },
                                     { 0, 1, 0, 1, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 },
                                     { 0, 1, 0, 0, 0, 0 }
};
